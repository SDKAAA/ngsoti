\section*{Executive Summary}
\addcontentsline{toc}{section}{Executive Summary}

This deliverable adheres to the definition outlined in the grant agreement, as stated below:

\textbf{ Interim report with key activities of the NGSOTI infrastructure, including its deployment and usage status}.


\chapter{Introduction}
Replace with actual content.

\chapter{NGSOTI setup and operation}
In the NGSOTI project, the consortium closely monitored the behavior and requirements of its user communities, ensuring the development and customization of tools tailored to support efficient SOC operations. These tools are detailed in the following section.

\section{Optimized Tools for Streamlined SOC Operations}


\subsection{Tenzir}


\subsection{SkillAegis}
SkillAegis is an excellent outcome of the NGSOTI project, aligning seamlessly with its mission to train the next generation of Security Operations Center (SOC) operators. While the project emphasizes creating operational infrastructures and fostering hands-on training environments, SkillAegis addresses the critical human element by providing a platform for scenario-based training.
SkillAegis equips trainees with practical skills to navigate these challenges by simulating real-world incidents in a controlled, dynamic environment.
This tool complements the project's vision by enhancing traditional training methods, including academic curricula and industry-led guest lectures, with interactive, real-data-driven cyber range exercises. Hosted by CIRCL and supported by Restena's network interconnectivity, the infrastructure enables SkillAegis to play a pivotal role in preparing SOC operators for future challenges while fostering a collaborative and robust educational ecosystem.

On August 14, 2024, the release of \textbf{SkillAegis v1.0.0} was announced on misp-project.org. SkillAegis is an open-source platform developed as part of the NGSOTI project to advance cybersecurity training and capacity building. SkillAegis is designed to enhance cyber threat intelligence training through realistic, scenario-based exercises, enabling participants to simulate and respond to real-world cyber incidents.

\subsubsection{Key Features of SkillAegis}
\begin{itemize}
	\item \textbf{Scenario Creation:} Trainers can design customized exercises with specific learning objectives, simulating various cyber incidents to develop practical skills in threat intelligence and information management.
	\item \textbf{Exercise Execution \& Monitoring:} The platform allows trainers to deploy and oversee scenarios in real-time, using a live dashboard to track participant progress and provide immediate feedback.
\end{itemize}

\subsubsection{Components of the SkillAegis Platform}
\begin{itemize}
	\item \textbf{SkillAegis Main Application:} Serves as the core component, managing scenario execution and integrating ready-to-use training modules.
	\item \textbf{SkillAegis Editor:} Enables trainers to create new exercises, including metadata, injects (tasks), execution order, and evaluation criteria. It also features an Inject Tester to optimize scenarios.
	\item \textbf{SkillAegis Dashboard:} Facilitates training session execution and provides real-time insights into participant progress, including completion status and logs of user actions.
\end{itemize}

\subsubsection{Integration with MISP}
SkillAegis was specifically developed to integrate with MISP (Threat Sharing Platform), enhancing training quality. Injects can directly interact with data within MISP, querying and monitoring user activity. To enable this, SkillAegis connects to a training MISP instance via a valid site-admin API (Application Programming Interface) Key.

\subsubsection{Availability and Licensing}
SkillAegis is freely available as open-source software under the AGPLv3 license, reflecting its EU project origins and commitment to supporting the cybersecurity community. The platform can be downloaded and utilized at no cost.

For more information and access to SkillAegis, visit the \href{https://www.misp-project.org/2024/08/14/SkillAegis-v1.0.0.html/}{official announcement}.


\subsection{MISP training Infrastructure}

\subsection{Kunai}

While Linux workstations may not rival Windows or macOS systems in popularity, Linux systems dominate the server landscape, often hosting critical services such as web servers, databases, and many public systems accessible via the Internet. However, Linux security monitoring for Security Operation Centers (SOCs) frequently lacks the detailed visibility available on Windows systems, where free tools like Sysmon\footnote{\href{https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon}{https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon}} exist. SOC engineers often rely on audit logs or application logs to create detection scenarios, but these sources are not always security-focused and typically lack correlation capabilities necessary for understanding the occurrence of suspicious events.

An attempt to port Microsoft Sysmon to Linux has been made\footnote{\href{https://github.com/microsoft/SysmonForLinux}{https://github.com/microsoft/SysmonForLinux}}. However, the project suffers from several Linux-specific design flaws and has not seen maintenance since its release, making it unappealing for potential users. Other projects, such as \textbf{Tracee}\footnote{\href{https://github.com/aquasecurity/tracee}{https://github.com/aquasecurity/tracee}} and \textbf{Falco}\footnote{\href{https://github.com/falcosecurity/falco}{https://github.com/falcosecurity/falco}}, address Linux security visibility issues but lack some key features offered by Sysmon, including threat-hunting capabilities and event correlation for root cause analysis.

From our experience, alert contextualization and root cause analysis are crucial for enabling SOC operators to triage alerts effectively and for incident responders to thoroughly investigate security events. These needs motivated the development of \textbf{Kunai}, with the goal of providing a tailored security visibility tool for Linux systems. Kunai empowers SOC engineers and incident responders to perform their jobs more effectively and efficiently.

As part of the \textbf{NGSOTI} project, Kunai has undergone significant enhancements to achieve its goals. Integration with \textbf{MISP}\footnote{\href{https://www.misp-project.org/}{https://www.misp-project.org/}} enables Kunai to leverage Indicators of Compromise (IOCs) and threat intelligence shared through the platform. This fosters community-based intelligence sharing and simplifies the detection of known threats. Additionally, a rule engine was developed to facilitate log filtering and the creation of highly customizable detection rules tailored to specific needs and environments. The rule format was designed to be simple to write and share, promoting collaboration and distribution through platforms like \textbf{MISP}. These contributions make data sharing among SOCs seamless, allowing incidents to be detected and addressed more quickly.

Some of the other contributions made under \textbf{NGSOTI} include:
\begin{itemize}
	\item Integration of numerous new security events, providing enhanced visibility, analysis, and detection capabilities.
	\item File scanning using \textbf{Yara}\footnote{\href{https://virustotal.github.io/yara-x/}{https://virustotal.github.io/yara-x/}} rules for malicious file detection.
	\item \textbf{Community-ID}\footnote{\href{https://github.com/corelight/community-id-spec}{https://github.com/corelight/community-id-spec}} support, enabling correlation between system logs and network logs from tools like \textbf{Suricata}\footnote{\href{https://suricata.io/}{https://suricata.io/}} and \textbf{Zeek}\footnote{\href{https://zeek.org/}{https://zeek.org/}}.
\end{itemize}

Finally, several production-readiness features have been implemented, such as automated installation and configuration and log rotation. Background tasks such as maintaining an up-to-date website and documentation\footnote{\href{https://why.kunai.rocks/}{https://why.kunai.rocks/}}, monitoring Linux kernel changes to reflect in the project, and refactoring code have also been undertaken to ensure the project's long-term reliability and relevance.


\chapter{NGSOTI Core Infrastructure}

NGSOTI Core Infrastrucutre encompassed the software stack that will be used for hosting the services and the datasets that trainees and trainers will have access to in the frame of the action. The core infrastructure has been deployed on the hardware procured for the action (see mgsoti-milestone3-report.pdf for more details):

\begin{itemize}
	\item {\bf{ngsoti1}} is a physical server that hosts LXC containers and that host the virtual training network,
	\item {\bf{ngsoti2}} is a physical server that hosts the datasets used during training (e.g. collections from the blackhole, malware samples, etc.)
	\item {\bf{ngsoti3}} is a physical server that host auxiliary GPU accelarated workloads (e.g. A.I webservices)
\end{itemize}



\begin{figure}[ht]
	\centering
	\includegraphics[width=\textwidth]{./img/NGSOTI-architecture.png}
	\caption{NGSOTI core infrastructure diagram}
	\label{fig1}
	\end{figure}

The virtual training environment hosted on {\bf{ngsoti1}} is built around two main pieces of technology:

\begin{itemize}

	\item {\bf{LXC}} is a container runtime for
	linux{\footnote{\url{https://linuxcontainers.org/}}}. It allows for the
	creation of containers holding the differents services used during
	trainings, as well as for the creation of a virtual network that users will
	use to connect to the differents services. The LXC infrastructure offers
	profiles that can be applied on newly created containers to easily create
	SSH admin access, and mount datasets from {\bf{ngsoti2}}
	
	\item {\bf{tailscale}}{\footnote{\url{https://tailscale.com/}}} is a VPN
	(Virtual Private Network) technology that allows us to give access to the
	virtual network from anywhere where the tailscale client can run. In
	addition to tailscale, we run
	{\bf{headscale}}{\footnote{\url{https://headscale.net/stable/}}} that is an open
	source project used to manage tailscale authentication.
	
\end{itemize}

As depicted on~\ref{fig1}, {\bf{ngsoti1}} holds a headscale LXC container to
manage the authentication of users, and Access Control Lists. Within the LXC
virtual network, there is a special LXC container that is also part of the
tailscale VPN (the tailnet) that acts as a router to the virtual training
infrastructure. 

Eventually trainers, trainees, and admin alike can access the virutal training infrastructure throught the tailnet.

The documentation for each of these components is accessible in the project's internal notes:

\begin{itemize}
	\item overall architecture \url{https://github.com/ngsoti/internal-notes/blob/main/WP2/README.md}
	\item how to create containers \url{https://github.com/ngsoti/internal-notes/blob/main/WP2/containers.md}
	\item how to manage headscale \url{https://github.com/ngsoti/internal-notes/blob/main/WP2/headscale.md}
	\item how to onboard new admin user \url{https://github.com/ngsoti/internal-notes/blob/main/WP2/onboarding.md}
	\item how to manage the tailnet router \url{https://github.com/ngsoti/internal-notes/blob/main/WP2/tailnet-router.md}
\end{itemize}

\chapter{NGSOTI trainings}
Some EU regulations, such as NIS2 and DORA, have created a significant boost in the demand for NGSOTI training sessions. These sessions are designed to ensure organizations are well-prepared to meet the requirements of these regulations, which are often enforced starting in 2025. A key focus of these regulations is the establishment of local SOC (Security Operations Center).

The NIS2 Directive mandates that regulated entities implement robust incident response capabilities and maintain effective security operations. Specifically, organizations must establish comprehensive incident handling policies that define roles, responsibilities, and procedures for detecting, analyzing, and responding to security incidents. These policies also cover post-incident activities such as recovery, documentation, and reporting.

Furthermore, the directive emphasizes the importance of continuous monitoring and logging of network and information systems to promptly detect and address potential threats. Entities are expected to:

\begin{itemize}
	\item Implement automated monitoring where feasible.
	\item Regularly review logs to identify unusual activities.
	\item Ensure accurate time synchronization across systems to facilitate effective incident analysis.
\end{itemize}

By adhering to these requirements, organizations can enhance their resilience against cyber threats and ensure compliance with the NIS2 Directive. Article 21, under point (b), explicitly requires the establishment of incident handling capabilities.

Importantly, NIS2 extends its scope to include entities such as SMEs (Small and Medium Enterprises) involved in the supply chains of Operators of Essential Services (OES) or Digital Service Providers (DSP), which were not regulated under the original NIS Directive. These entities are now required to set up local incident response capabilities.

Given this regulatory landscape, the NGSOTI framework provided an excellent opportunity to conduct targeted incident response training. These efforts were aimed at equipping participants with the skills and knowledge required to comply with these critical regulations. The incident response trainings conducted are detailed in the table below:


\begin{table}
	\begin{tabular}{lllll}
		\hline
		Date       & Training            & Number of participants & Sector    & Target audiance         \\
		\hline
		2024-07-05 & Kunai               & 12                     & Multiple  & Open source enthusiasts \\
		2024-11-08 & Incident Response   & 9                      & Finance   & Security professionals  \\
		2024-11-10 & Incident Response   & 4                      & Finance   & Security professionals  \\
		2024-11-11 & Incident Response   & 4                      & Finance   & Security professionals  \\
		2024-11-23 & Forensic            & 4                      & Finance   & Security professionals  \\
		2024-11-24 & Forensic            & 4                      & Finance   & Security professionals  \\
  		2024-12-03 & Awareness		 & 14 			  & Education & Engineering students    \\
    		2024-12-10 & Awareness		 & 10 			  & Education & Engineering students    \\
		2024-12-11 & Forensic            & xx                     & Education & Engineering students    \\
		2024-12-16 & MISP threat sharing & xx                     & Education & Engineering students    \\
		\hline
	\end{tabular}
\end{table}

\chapter{NGSOTI research}

\chapter{NGSOTI core working group activities}
This section describes the activities of the core working group as defined in the grant agreement. The purpose of the core working group is to ensure that the NGSOTI infrastructure and use cases are as closely aligned as possible with real-world requirements. In 2023, a subset of the core working group convened under the framework of CERT.lu, which brings together key SOC operators, ISPs, and CSIRTs/CERTs.

\chapter{NGOSTI and operational usage status}

The NGSOTI infrastructure is currently in the process of being set up. Some components, such as the MISP training infrastructure, have already been successfully utilized in MISP training sessions.

\chapter{Dissemination and endorsement}

